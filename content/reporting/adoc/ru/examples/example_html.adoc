:sourcesdir: ../../../source

[[example_html]]
=== Пример отчета HTML/PDF

Предположим, нам нужно создать отчет с альбомной ориентацией страниц, нумерацией страниц, а также фиксированными заголовком и подвалом на каждой странице, которые мы настроим через правила и свойства CSS. Формат вывода отчета - HTML с конвертацией в PDF.

Полностью готовый пример этого отчета вместе с тестовым проектом можно скачать с https://github.com/cuba-labs/reports-pdf-page-settings[CUBA GitHub].

. Модель данных

+
--
Отчет будет отображать информацию о сущности `Client`. Она содержит два строковых атрибута, `title` и `summary`, которые мы используем в структуре отчета.

[source, java]
----
include::{sourcesdir}/examples_html.java[]
----
--

. <<structure,Создание отчета>>
+
--
Создадим простой отчет без параметров. Запрос JPQL возвращает список всех клиентов с их локальными атрибутами: `title` и `summary`.

image::example_html_1.png[align="center"]
--

. <<template_html,Шаблон отчета>>.

+
--
Теперь создадим файл шаблона. В нем мы определим блоки заголовка и подвала, которые должны выводиться на каждой странице итогового документа PDF. Также используем свойство CSS `page-break-before`: `always`, которое будет создавать разрыв страницы перед каждым новым блоком информации о клиенте.

Мы также используем теги *FreeMarker* для вставки данных в тело отчета. Подробное руководство по FreeMarker находится здесь: https://freemarker.apache.org/docs/.

[source, html]
----
include::{sourcesdir}/examples_html.html[]
----
--

. Правила CSS

+
--
Используем следующий код CSS для разметки страницы PDF:

[source, css]
----
include::{sourcesdir}/examples_html_1.css[]
----

Далее определим положение заголовка и подвала:

[source, css]
----
include::{sourcesdir}/examples_html_2.css[]
----

Также настроим отступы для основного содержимого отчета, чтобы избежать наложения с заголовком и подвалом:

[source, css]
----
include::{sourcesdir}/examples_html_3.css[]
----

В итоге у нас получился файл `paging-template.html` со следующим содержанием:

[source, html]
----
include::{sourcesdir}/examples_html_5.html[]
----
--

. Загрузка шаблона и запуск отчета.
+
--

image::example_html_3.png[align="center"]

Как мы видим, отчет содержит титульную страницу и разрывы перед каждой страницей с информацией о клиенте, а также заголовок и подвал на каждой странице:

image::example_html_2.png[align="center"]
--


