<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><appendix lang="en" id="open_office">
  <title>Installing and Configuring OpenOffice</title>
  <para>The report generator uses the  <application>OpenOffice / LibreOffice</application> package to output reports in PDF and DOC <link linkend="template_to_output">formats</link>. The installation to the computer containing the application server and configuration of this package is described below.</para>
  <para><emphasis role="bold">Installing and Configuring OpenOffice for Microsoft Windows</emphasis></para>
  <itemizedlist>
    <listitem>
      <para>Download the application at  <ulink url="http://openoffice.org">http://openoffice.org</ulink>.</para>
    </listitem>
    <listitem>
      <para>Install the application.</para>
    </listitem>
    <listitem>
      <para>In the  <link linkend="cuba.reporting.openoffice.path">cuba.reporting.openoffice.path</link> application property, specify the path to <application>OpenOffice.org</application>, for example:<programlisting><property>cuba.reporting.openoffice.path</property> = C:/Program Files (x86)/OpenOffice.org 3/program</programlisting></para>
    </listitem>
  </itemizedlist>
  <para><emphasis role="bold">Installing and Configuring LibreOffice on Ubuntu Server </emphasis></para>
  <itemizedlist>
    <listitem>
      <para>Install the <code>libreoffice</code> package, for example, by running the following command:  </para>
      <para><prompt>$ sudo apt-get install libreoffice</prompt></para>
    </listitem>
    <listitem>
      <para>In the  <link linkend="cuba.reporting.openoffice.path">cuba.reporting.openoffice.path</link> application property, specify the path to LibreOffice:<programlisting>cuba.reporting.openoffice.path = /usr/lib/libreoffice/program</programlisting></para>
    </listitem>
    <listitem>
      <para>If the server does not have window interface installed, LibreOffice will start with the error,  <code>Caused by: java.awt.HeadlessException: No X11 DISPLAY variable was set, but this program performed an operation which requires it</code>, or will simply terminate without error messages. To resolve this, set the  <link linkend="cuba.reporting.displayDeviceUnavailable">cuba.reporting.displayDeviceUnavailable</link> application property:<programlisting>cuba.reporting.displayDeviceUnavailable = true</programlisting></para>
    </listitem>
    <listitem>
      <para>You can run the following command to diagnose errors when starting LibreOffice:</para>
      <para><prompt>$ strace -e trace=signal /usr/lib/libreoffice/program/soffice.bin --headless --accept=&quot;socket,host=localhost,port=8100;urp&quot; --nologo --nolockcheck</prompt></para>
    </listitem>
  </itemizedlist>
</appendix>
