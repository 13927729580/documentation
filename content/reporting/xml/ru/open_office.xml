<?xml version='1.0' encoding='UTF-8'?>
<!-- This document was created with Syntext Serna Free. --><appendix lang="ru" id="open_office">
  <title>Установка и настройка OpenOffice</title>
  <para>Генератор отчетов использует пакет <application>OpenOffice / LibreOffice</application> для вывода отчетов в <link linkend="template_to_output">форматах</link>  PDF и DOC. Ниже рассмотрена установка и настройка данного пакета на компьютере, содержащем сервер приложения. </para>
  <para><emphasis role="bold">Установка и настройка OpenOffice для Microsoft Windows</emphasis></para>
  <itemizedlist>
    <listitem>
      <para>Скачайте дистрибутив программы по адресу <ulink url="http://openoffice.org">http://openoffice.org</ulink>.</para>
    </listitem>
    <listitem>
      <para>Произведите установку программы.</para>
    </listitem>
    <listitem>
      <para>Укажите в свойстве приложения <link linkend="cuba.reporting.openoffice.path">cuba.reporting.openoffice.path</link>  путь к установленному <application>OpenOffice.org</application>, например:<programlisting><property>cuba.reporting.openoffice.path</property> = C:/Program Files (x86)/OpenOffice.org 3/program</programlisting></para>
    </listitem>
  </itemizedlist>
  <para><emphasis role="bold">Установка и настройка LibreOffice на сервере Ubuntu </emphasis></para>
  <itemizedlist>
    <listitem>
      <para>Установить пакет libreoffice, например, командой </para>
      <para><prompt>$ sudo apt-get install libreoffice</prompt></para>
    </listitem>
    <listitem>
      <para>Указать в свойстве приложения <link linkend="cuba.reporting.openoffice.path">cuba.reporting.openoffice.path</link> путь к установленному LibreOffice:<programlisting>cuba.reporting.openoffice.path = /usr/lib/libreoffice/program</programlisting></para>
    </listitem>
    <listitem>
      <para>Если на сервере не установлен оконный интерфейс, то LibreOffice при старте будет выдавать ошибку вида <code>Caused by: java.awt.HeadlessException: No X11 DISPLAY variable was set, but this program performed an operation which requires it</code>, или же просто завершаться без сообщений об ошибках. Для устранения проблемы установите свойство приложения <link linkend="cuba.reporting.displayDeviceUnavailable">cuba.reporting.displayDeviceUnavailable</link>:<programlisting>cuba.reporting.displayDeviceUnavailable = true</programlisting></para>
    </listitem>
    <listitem>
      <para>Для диагностики ошибок при старте <application>LibreOffice</application> можно выполнить следующую команду:</para>
      <para><prompt>$ strace -e trace=signal /usr/lib/libreoffice/program/soffice.bin --headless --accept=&quot;socket,host=localhost,port=8100;urp&quot; --nologo --nolockcheck</prompt></para>
    </listitem>
  </itemizedlist>
</appendix>
