:sourcesdir: ../../../../source

[[gui_desktop]]
==== Специфика Desktop Client

Реализация универсального пользовательского интерфейса в <<app_tiers,блоке>> *Desktop Client* основана на *Java Swing*. Рассмотрим основные классы, входящие в состав инфраструктуры десктоп клиента.

.Классы инфраструктуры Desktop Client
image::DesktopClientInfrastructure.png[align="center"]

* `App` - центральный класс инфраструктуры десктоп приложения. Содержит ссылки на `Connection` и главный `TopLevelFrame`, а также методы инициализации и получения параметров приложения (см. ниже).
+
В конкретном приложении необходимо создать собственный класс-наследник `App` и переопределить в нем следующие методы:

** `getDefaultAppPropertiesConfig` - должен возвращать строку, в которой через пробел перечислены <<app_properties_files,файлы свойств приложения>>, например:
+
[source, java]
----
include::{sourcesdir}/gui/desktopclient_1.java[]
----

** `getDefaultHomeDir` - должен возвращать путь к каталогу, в котором приложение будет хранить временные и рабочие файлы, например:
+
[source, java]
----
include::{sourcesdir}/gui/desktopclient_2.java[]
----

** `getDefaultLogConfig` - должен возвращать имя файла настройки Logback, если таковой определен в проекте. Например:
+
[source, java]
----
include::{sourcesdir}/gui/desktopclient_3.java[]
----
+
Кроме того, в собственном классе-наследнике `App` необходимо определить метод `main()` следующим образом:
+
[source, java]
----
include::{sourcesdir}/gui/desktopclient_4.java[]
----

* `Connection` - класс, обеспечивающий функциональность подключения к среднему слою и хранящий пользовательскую сессию <<userSession,UserSession>>. 

* `LoginDialog` - диалог логина пользователя. В конкретном приложении можно создать наследника `LoginDialog` и переопределить метод `createLoginDialog()` класса `App` для его использования.

* `TopLevelFrame` - наследник `JFrame`, являющийся окном самого верхнего уровня. В приложении существует как минимум один экземпляр данного класса, создаваемый при старте приложения и содержащий главное меню. Этот экземпляр возвращается методом `getMainFrame()` класса `App`.
+
При отделении пользователем вкладок главного окна или компонента <<gui_TabSheet,TabSheet>> (см. атрибут `detachable`) создаются дополнительные экземпляры `TopLevelFrame`, не содержащие главного меню.

* `WindowManager` - центральный класс, реализующий логику работы экранов системы. Ему делегируются вызовы `openWindow()`, `openEditor()`, `showMessageDialog()` и другие методы интерфейса `Frame`, реализуемого <<screen_controller,контроллерами>> экранов. Класс `WindowManager` расположен в общем модуле *gui* платформы и является абстрактным. В модуле *desktop* имеется конкретный класс `DesktopWindowManager`, реализующий специфику десктоп клиента.
+
Как правило, `WindowManager` не используется в прикладном коде напрямую.

* `ExceptionHandlers` - содержит коллекцию <<exceptionHandlers,обработчиков исключений клиентского уровня>>.

include::gui_desktop/desktopComponentsHelper.adoc[]

